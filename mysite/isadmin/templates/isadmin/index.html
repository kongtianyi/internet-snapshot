<!DOCTYPE html>
<html lang="en">
	<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <title>互联网站点劫持检测系统</title>

    {% load static %}

    <meta name="description" content="Dynamic tables and grids using jqGrid plugin" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

    <link rel="shortcut icon" href="/static/isadmin/images/favicon.ico">

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="{% static 'isadmin/css/bootstrap.min.css' %}" />
    <link rel="stylesheet" href="{% static 'isadmin/font-awesome/4.5.0/css/font-awesome.min.css' %}" />

    <!-- page specific plugin styles -->

    <!-- text fonts -->
    <link rel="stylesheet" href="{% static 'isadmin/css/fonts.googleapis.com.css' %}" />

    <!-- ace styles -->
    <link rel="stylesheet" href="{% static 'isadmin/css/ace.min.css' %}" class="ace-main-stylesheet" id="main-ace-style" />

    <!--[if lte IE 9]>
			<link rel="stylesheet" href="{% static 'isadmin/css/ace-part2.min.css' %}" class="ace-main-stylesheet" />
		<![endif]-->
    <link rel="stylesheet" href="{% static 'isadmin/css/ace-skins.min.css' %}" />
    <link rel="stylesheet" href="{% static 'isadmin/css/ace-rtl.min.css' %}" />

    <!--[if lte IE 9]>
		  <link rel="stylesheet" href="{% static 'isadmin/css/ace-ie.min.css' %}" />
		<![endif]-->

    <!-- inline styles related to this page -->

    <!-- ace settings handler -->
    <script src="{% static 'isadmin/js/ace-extra.min.js' %}"></script>

    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

    <!--[if lte IE 8]>
		<script src="{% static 'isadmin/js/html5shiv.min.js' %}"></script>
		<script src="{% static 'isadmin/js/respond.min.js' %}"></script>
		<![endif]-->
</head>

	<body class="no-skin">
        <div id="navbar" class="navbar navbar-default ace-save-state">
            <div class="navbar-container ace-save-state" id="navbar-container">
                <button type="button" class="navbar-toggle menu-toggler pull-left" id="menu-toggler" data-target="#sidebar">
                    <span class="sr-only">Toggle sidebar</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <div class="navbar-header pull-left">
                    <a href="index.html" class="navbar-brand">
                        <small>
                            <i class="fa fa-leaf"></i>
                            互联网站点劫持检测系统
                        </small>
                    </a>
                </div>

                <div class="navbar-buttons navbar-header pull-right" role="navigation">
                    <ul class="nav ace-nav">

                        <li class="light-blue dropdown-modal">
                            <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                                <img class="nav-user-photo" src="{% static 'isadmin/images/avatars/user.jpg' %}" alt="Jason's Photo" />
                                <span class="user-info">
									<small>欢迎你,</small>
									{{ nickname }}
								</span>

                                <i class="ace-icon fa fa-caret-down"></i>
                            </a>

                            <ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                                <li>
                                    <a href="#">
                                        <i class="ace-icon fa fa-cog"></i>
                                        设置
                                    </a>
                                </li>

                                <li>
                                    <a href="profile.html">
                                        <i class="ace-icon fa fa-user"></i>
                                        个人信息
                                    </a>
                                </li>

                                <li>
                                    <a data-toggle="modal" data-target="#invite_modal">
                                        <i class="ace-icon fa fa-gift"></i>
                                        生成邀请码
                                    </a>
                                </li>

                                <li class="divider"></li>

                                <li>
                                    <a href="/isadmin/logout">
                                        <i class="ace-icon fa fa-power-off"></i>
                                        退出登陆
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div><!-- /.navbar-container -->
        </div>

		<div class="main-container ace-save-state" id="main-container">
			<script type="text/javascript">
				try{ace.settings.loadState('main-container')}catch(e){}
			</script>

			<div id="sidebar" class="sidebar responsive ace-save-state">
                <script type="text/javascript">
                    try{ace.settings.loadState('sidebar')}catch(e){}
                </script>

                <div class="sidebar-shortcuts" id="sidebar-shortcuts">
                    <div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
                        <button class="btn btn-success">
                            <i class="ace-icon fa fa-signal"></i>
                        </button>

                        <button class="btn btn-info">
                            <i class="ace-icon fa fa-pencil"></i>
                        </button>

                        <button class="btn btn-warning">
                            <i class="ace-icon fa fa-users"></i>
                        </button>

                        <button class="btn btn-danger">
                            <i class="ace-icon fa fa-cogs"></i>
                        </button>
                    </div>

                    <div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
                        <span class="btn btn-success"></span>

                        <span class="btn btn-info"></span>

                        <span class="btn btn-warning"></span>

                        <span class="btn btn-danger"></span>
                    </div>
                </div><!-- /.sidebar-shortcuts -->

                <ul class="nav nav-list">
                    <li class="sidebar-item has-son open">
                        <a href="#" class="dropdown-toggle">
                            <i class="menu-icon fa fa-tachometer"></i>
                            <span class="menu-text"> 实时监控 </span>

                            <b class="arrow fa fa-angle-down"></b>
                        </a>

                        <b class="arrow"></b>

                        <ul class="submenu">
                            <li class="sidebar-item active">
                                <a href="/isadmin/vps_monitor" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    VPS监控
                                </a>
                                <b class="arrow"></b>
                            </li>
                            <li class="sidebar-item">
                                <a href="http://114.67.225.0:15672/" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    RabbitMQ
                                </a>
                                <b class="arrow"></b>
                            </li>
                            <li class="sidebar-item">
                                <a href="/isadmin/real_time_log" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    实时日志
                                </a>
                                <b class="arrow"></b>
                            </li>
                        </ul>
                    </li>

                    <li class="sidebar-item has-son">
                        <a href="#" class="dropdown-toggle">
                            <i class="menu-icon fa fa-camera"></i>
                            <span class="menu-text"> 快照任务 </span>

                            <b class="arrow fa fa-angle-down"></b>
                        </a>

                        <b class="arrow"></b>

                        <ul class="submenu">
                            <li class="sidebar-item active">
                                <a href="/isadmin/add_task" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    添加任务
                                </a>
                                <b class="arrow"></b>
                            </li>
                            <li class="sidebar-item">
                                <a href="/isadmin/get_tasks" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    任务视图
                                </a>
                                <b class="arrow"></b>
                            </li>
                        </ul>
                    </li>

                    <li class="sidebar-item">
                        <a href="/isadmin/one_button" target="main-iframe">
							<i class="menu-icon fa  fa-bolt"></i>
							<span class="menu-text"> 一键功能 </span>
						</a>

                        <b class="arrow"></b>
                    </li>

                    <li class="sidebar-item has-son">
                        <a href="#" class="dropdown-toggle">
                            <i class="menu-icon fa  fa-bar-chart-o"></i>
                            <span class="menu-text"> 数据报表 </span>

                            <b class="arrow fa fa-angle-down"></b>
                        </a>

                        <b class="arrow"></b>

                        <ul class="submenu">
                            <li class="sidebar-item">
                                <a href="/isadmin/report/redirect_records" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    重定向页面记录
                                </a>
                                <b class="arrow"></b>
                            </li>
                            <li class="sidebar-item">
                                <a href="/isadmin/report/filted_suspicious" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    可疑外链过滤结果
                                </a>
                                <b class="arrow"></b>
                            </li>
                            <li class="sidebar-item">
                                <a href="/isadmin/report/compare_unique" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    多地快照比对结果
                                </a>
                                <b class="arrow"></b>
                            </li>
                        </ul>
                    </li>

                    <li class="sidebar-item has-son">
                        <a href="#" class="dropdown-toggle">
                            <i class="menu-icon fa fa-pencil-square-o"></i>
                            <span class="menu-text"> 数据库管理 </span>

                            <b class="arrow fa fa-angle-down"></b>
                        </a>

                        <b class="arrow"></b>

                        <ul class="submenu">
                            <li class="sidebar-item">
                                <a href="/isadmin/pubsoc_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    公共正常外链主域名
                                </a>

                                <b class="arrow"></b>
                            </li>

                            <li class="sidebar-item">
                                <a href="/isadmin/prisoc_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    私有正常外链主域名
                                </a>

                                <b class="arrow"></b>
                            </li>

                            <li class="sidebar-item">
                                <a href="/isadmin/malicious_domains_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    恶意外链主域名
                                </a>

                                <b class="arrow"></b>
                            </li>

                            <li class="sidebar-item">
                                <a href="/isadmin/snapshot_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    网页快照表
                                </a>

                                <b class="arrow"></b>
                            </li>

                            <li class="sidebar-item">
                                <a href="/isadmin/suspicious_records_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    可疑外链表
                                </a>

                                <b class="arrow"></b>
                            </li>

                            <li class="sidebar-item">
                                <a href="/isadmin/pocr_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    比对结果表
                                </a>

                                <b class="arrow"></b>
                            </li>

                            <!-- <li class="sidebar-item">
                                <a href="/isadmin/dcbp_list" target="main-iframe">
                                    <i class="menu-icon fa fa-caret-right"></i>
                                    定时任务表
                                </a>

                                <b class="arrow"></b>
                            </li> -->
                        </ul>
                    </li>

                    <li class="sidebar-item">
                        <a href="/isadmin/logout">
                            <i class="menu-icon fa fa-power-off"></i>
                            <span class="menu-text"> 退出登陆 </span>
                        </a>
                    </li>

                </ul><!-- /.nav-list -->

                <div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
                    <i id="sidebar-toggle-icon" class="ace-icon fa fa-angle-double-left ace-save-state" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
                </div>
            </div>

            <div class="main-content">
			    <iframe id="main-iframe" name="main-iframe" src="/isadmin/vps_monitor" frameborder="0px" width="100%" scrolling="auto" style="background: white;"></iframe>
            </div>

			<div class="footer" id="footer">
                <div class="footer-inner">
                    <div class="footer-content">
                        <span class="bigger-120">
                        <span class="blue bolder">互联网内容</span>
							异常行为管理系统 &copy; 2017-2018.
                        </span>
                    </div>
                </div>
            </div>

			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
				<i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
			</a>
		</div><!-- /.main-container -->

        <div id="invite_modal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">生成邀请码</h4>
                    </div>
                    <div class="modal-body">
                        <div class="input-group">
                            <input class="form-control input-mask-product" type="text" id="invite_code">
                            <span id="invite_btn" class="input-group-addon" data-clipboard-target="#invite_code">
								<i class="ace-icon glyphicon glyphicon-share"></i>
							</span>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="get_invite_code();">生成</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

		<!-- basic scripts -->

        <!--[if !IE]> -->
            <script src="{% static 'isadmin/js/jquery-2.1.4.min.js' %}"></script>
        <!-- <![endif]-->

        <!--[if IE]>
            <script src="{% static 'isadmin/js/jquery-1.11.3.min.js' %}"></script>
        <![endif]-->
        <script type="text/javascript">
            if('ontouchstart' in document.documentElement) document.write("<script src='{% static 'isadmin/js/jquery.mobile.custom.min.js' %}'>"+"<"+"/script>");
        </script>
        <script src="{% static 'isadmin/js/bootstrap.min.js' %}"></script>

        <!-- page specific plugin scripts -->
        <script src="{% static 'isadmin/js/clipboard.min.js' %}"></script>

        <!--[if lte IE 8]>
		  <script src="{% static 'isadmin/js/excanvas.min.js' %}"></script>
		<![endif]-->
        <script src="{% static 'isadmin/js/jquery-ui.custom.min.js' %}"></script>
        <script src="{% static 'isadmin/js/jquery.ui.touch-punch.min.js' %}"></script>
        <script src="{% static 'isadmin/js/jquery.easypiechart.min.js' %}"></script>
        <script src="{% static 'isadmin/js/jquery.sparkline.index.min.js' %}"></script>

        <!-- ace scripts -->
        <script src="{% static 'isadmin/js/ace-elements.min.js' %}"></script>
        <script src="{% static 'isadmin/js/ace.min.js' %}"></script>

        <!-- 自定义script -->
        <script>
            /* 调整main-iframe的高度 */
            function suit_size() {
                var window_height = $(window).height();
                var navbar_height = $('#navbar').outerHeight(true);
                var footer_height = $('#footer').outerHeight(true);
                var content_height = window_height - navbar_height - footer_height - 5;
                $('#main-iframe').height(content_height);
            }
            $(document).ready(function () {
                $('#footer').css("padding", "56px 0px 0px 0px");
                suit_size();
            });
            $(window).resize(function(){
                suit_size();
            });

            /*侧边栏指示键的逻辑*/
            $('.sidebar-item').click(function () {
                var active = $(this);
                if(!active.hasClass("has-son")) {  // 有儿子就只有子菜单的开闭作用
                    $('.sidebar-item').removeClass("active");
                    if(active.parent().hasClass("submenu")) {
                       active.parent().parent().addClass("active");
                    }
                    active.addClass("active");
                }
            });

            /* 发送生成邀请码请求 */
            function get_invite_code() {
                $.ajax({
                    "url": "/isadmin/invite_code_action",
                    "method": "post",
                    "data": {
                        "inviter_id": {{ request.session.id }},
                    },
                    "success": function (data) {
                        $("#invite_code").val(data["invite_code"]);
                    },
                    "error": function () {
                        alert("服务器错误，验证码生成失败。");
                    }
                });
            }

            /* 将邀请码复制到剪切板 */
            var clipboard = new ClipboardJS('#invite_btn');
        </script>
	</body>
</html>
